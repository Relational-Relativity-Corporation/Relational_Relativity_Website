<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRR Security Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen">
    <div class="max-w-7xl mx-auto p-6 space-y-6">
        <!-- Header -->
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-white flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                    </svg>
                    QRR Security Dashboard
                </h1>
                <p class="text-slate-400 mt-1">Relation-Primary Authentication Monitoring</p>
            </div>
            <button id="simulateBtn" onclick="toggleSimulation()" class="px-6 py-3 rounded-lg font-semibold transition-all bg-blue-500 hover:bg-blue-600 text-white">
                Start Simulation
            </button>
        </div>

        <!-- Main Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <!-- Coherence Score -->
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-slate-400 text-sm">Coherence Score</p>
                        <p id="coherenceValue" class="text-3xl font-bold text-white mt-1">85.0%</p>
                    </div>
                    <svg class="w-10 h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <div class="mt-4 flex items-center gap-2 text-sm">
                    <svg id="coherenceTrend" class="w-4 h-4 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                    </svg>
                    <span class="text-slate-400">vs baseline</span>
                </div>
            </div>

            <!-- Auth Score -->
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-slate-400 text-sm">Auth Score</p>
                        <p id="authScoreValue" class="text-3xl font-bold text-white mt-1">82.0%</p>
                    </div>
                    <svg class="w-10 h-10 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                    </svg>
                </div>
                <div class="mt-4">
                    <div class="w-full bg-slate-700 rounded-full h-2">
                        <div id="authScoreBar" class="bg-purple-400 h-2 rounded-full transition-all duration-500" style="width: 82%"></div>
                    </div>
                </div>
            </div>

            <!-- Active Sessions -->
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-slate-400 text-sm">Active Sessions</p>
                        <p id="sessionCount" class="text-3xl font-bold text-white mt-1">0</p>
                    </div>
                    <svg class="w-10 h-10 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </div>
                <p class="text-slate-400 text-sm mt-4">Legitimate users</p>
            </div>

            <!-- Threat Level -->
            <div id="threatLevelCard" class="border rounded-lg p-6 text-green-600 bg-green-50 border-green-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium">Threat Level</p>
                        <p id="threatLevel" class="text-3xl font-bold mt-1 uppercase">NORMAL</p>
                    </div>
                    <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <p class="text-sm mt-4">Blocked: <span id="blockedCount">0</span></p>
            </div>
        </div>

        <!-- Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Coherence Timeline -->
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
                <h2 class="text-xl font-bold text-white mb-4">Coherence & Stability Timeline</h2>
                <div style="height: 250px;">
                    <canvas id="coherenceChart"></canvas>
                </div>
            </div>

            <!-- Security Events -->
            <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
                <h2 class="text-xl font-bold text-white mb-4">Recent Security Events</h2>
                <div id="securityEvents" class="space-y-3 max-h-[250px] overflow-y-auto">
                    <div class="text-center py-8 text-slate-400">
                        <svg class="w-12 h-12 mx-auto mb-2 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <p>No threats detected</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manual Controls -->
        <div class="bg-slate-800 border border-slate-700 rounded-lg p-6">
            <h2 class="text-xl font-bold text-white mb-4">Manual Attack Simulation</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <button onclick="simulateLegitimate()" class="px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all">
                    Legitimate Login
                </button>
                <button onclick="simulateAttack('brute_force')" class="px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-all">
                    Brute Force
                </button>
                <button onclick="simulateAttack('credential_stuffing')" class="px-4 py-3 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-semibold transition-all">
                    Credential Stuffing
                </button>
                <button onclick="simulateAttack('session_hijack')" class="px-4 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-all">
                    Session Hijacking
                </button>
            </div>
        </div>

        <!-- QRR Advantage -->
        <div class="bg-gradient-to-r from-blue-900 to-purple-900 border border-blue-700 rounded-lg p-6">
            <h2 class="text-xl font-bold text-white mb-4">üéØ QRR Relation-Primary Advantage</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-white">
                <div>
                    <h3 class="font-semibold mb-2 text-blue-200">Traditional (Object-Primary)</h3>
                    <ul class="space-y-2 text-sm text-slate-300">
                        <li>‚ùå Checks only username + password</li>
                        <li>‚ùå No context awareness</li>
                        <li>‚ùå Vulnerable to credential theft</li>
                        <li>‚ùå Reactive detection</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold mb-2 text-purple-200">QRR (Relation-Primary)</h3>
                    <ul class="space-y-2 text-sm text-slate-300">
                        <li>‚úÖ Measures relational field coherence</li>
                        <li>‚úÖ Context-aware (location, device, behavior)</li>
                        <li>‚úÖ Adapts to legitimate drift</li>
                        <li>‚úÖ Proactive anomaly detection</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // QRR Mathematics
        class RelationalFieldCoordinator {
            constructor(masterFieldStrength = 1.0) {
                this.masterFieldStrength = masterFieldStrength;
            }

            calculateCoordinatedField(x, y, z, timeFactor = 0.0) {
                const r = Math.sqrt(x*x + y*y + z*z + 1e-6);
                const theta = Math.atan2(y, x);
                const phi = Math.atan2(z, Math.sqrt(x*x + y*y));
                
                const primary = Math.cos(r + timeFactor) * Math.sin(2*theta) * Math.cos(phi);
                const secondary = Math.sin(0.5*r - timeFactor) * Math.cos(theta) * Math.sin(2*phi);
                const tertiary = Math.cos(r * theta * phi * 0.01 + timeFactor * 0.1);
                
                const baseField = this.masterFieldStrength * (
                    primary * 1.0 + secondary * 0.8 + tertiary * 0.6
                );
                
                let coherence = (baseField + 2.4) / 4.8;
                coherence = Math.max(0.0, Math.min(1.0, coherence));
                
                let stability = 1.0 - Math.abs(baseField) / 2.4;
                stability = Math.max(0.0, Math.min(1.0, stability));
                
                return { baseField, coherence, stability };
            }
        }

        // State
        let isSimulating = false;
        let simulationInterval = null;
        let sessionCount = 0;
        let blockedCount = 0;
        let coherenceData = [];
        let stabilityData = [];
        let timeLabels = [];
        const maxDataPoints = 20;

        const fieldCoordinator = new RelationalFieldCoordinator();
        const userBaseline = {
            coherence: 0.85,
            location: [1.0, 2.0, 3.0],
            deviceId: 'alice_laptop_001'
        };

        // Chart setup
        const ctx = document.getElementById('coherenceChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: timeLabels,
                datasets: [
                    {
                        label: 'Coherence',
                        data: coherenceData,
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'Stability',
                        data: stabilityData,
                        borderColor: 'rgb(139, 92, 246)',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1,
                        grid: { color: 'rgba(75, 85, 99, 0.3)' },
                        ticks: { color: '#9CA3AF' }
                    },
                    x: {
                        grid: { color: 'rgba(75, 85, 99, 0.3)' },
                        ticks: { color: '#9CA3AF', maxRotation: 45 }
                    }
                },
                plugins: {
                    legend: {
                        labels: { color: '#E5E7EB' }
                    }
                }
            }
        });

        function calculateThreatLevel(coherence) {
            if (coherence < 0.3) return 'critical';
            if (coherence < 0.5) return 'high';
            if (coherence < 0.7) return 'medium';
            if (coherence < 0.85) return 'low';
            return 'normal';
        }

        function getThreatColors(level) {
            const colors = {
                normal: { text: 'text-green-600', bg: 'bg-green-50', border: 'border-green-200' },
                low: { text: 'text-yellow-600', bg: 'bg-yellow-50', border: 'border-yellow-200' },
                medium: { text: 'text-orange-600', bg: 'bg-orange-50', border: 'border-orange-200' },
                high: { text: 'text-red-600', bg: 'bg-red-50', border: 'border-red-200' },
                critical: { text: 'text-purple-600', bg: 'bg-purple-50', border: 'border-purple-200' }
            };
            return colors[level] || colors.normal;
        }

        function updateDisplay(coherence, stability, authScore, threat) {
            document.getElementById('coherenceValue').textContent = (coherence * 100).toFixed(1) + '%';
            document.getElementById('authScoreValue').textContent = (authScore * 100).toFixed(1) + '%';
            document.getElementById('authScoreBar').style.width = (authScore * 100) + '%';
            document.getElementById('threatLevel').textContent = threat.toUpperCase();
            
            const colors = getThreatColors(threat);
            const card = document.getElementById('threatLevelCard');
            card.className = `border rounded-lg p-6 ${colors.text} ${colors.bg} ${colors.border}`;
            
            const trend = document.getElementById('coherenceTrend');
            if (coherence >= userBaseline.coherence) {
                trend.className = 'w-4 h-4 text-green-400';
            } else {
                trend.className = 'w-4 h-4 text-red-400';
            }
        }

        function addToChart(coherence, stability) {
            const time = new Date().toLocaleTimeString();
            
            if (timeLabels.length >= maxDataPoints) {
                timeLabels.shift();
                coherenceData.shift();
                stabilityData.shift();
            }
            
            timeLabels.push(time);
            coherenceData.push(coherence);
            stabilityData.push(stability);
            
            chart.update('none');
        }

        function addSecurityEvent(type, description, threat, coherence) {
            const colors = getThreatColors(threat);
            const timestamp = new Date().toLocaleTimeString();
            
            const eventHTML = `
                <div class="p-4 rounded-lg border ${colors.text} ${colors.bg} ${colors.border} fade-in">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-1">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                </svg>
                                <span class="font-semibold text-sm uppercase">${type.replace('_', ' ')}</span>
                            </div>
                            <p class="text-sm">${description}</p>
                            <p class="text-xs mt-2 opacity-70">
                                ${timestamp} ‚Ä¢ Coherence: ${(coherence * 100).toFixed(1)}%
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            const container = document.getElementById('securityEvents');
            container.innerHTML = eventHTML + container.innerHTML;
            
            // Keep only last 5 events
            while (container.children.length > 5) {
                container.removeChild(container.lastChild);
            }
        }

        function simulateLegitimate() {
            const noise = (Math.random() - 0.5) * 0.1;
            const location = userBaseline.location.map(coord => coord + noise * 0.05);
            const timeFactor = Date.now() / 10000;
            
            const field = fieldCoordinator.calculateCoordinatedField(...location, timeFactor);
            const authScore = field.coherence * 0.7 + field.stability * 0.3;
            const threat = calculateThreatLevel(field.coherence);
            
            sessionCount++;
            document.getElementById('sessionCount').textContent = sessionCount;
            
            updateDisplay(field.coherence, field.stability, authScore, threat);
            addToChart(field.coherence, field.stability);
        }

        function simulateAttack(attackType) {
            let location, description;
            
            switch(attackType) {
                case 'brute_force':
                    location = [1.0, 2.0, 3.0];
                    description = 'Brute Force Attack: Multiple failed login attempts detected';
                    break;
                case 'credential_stuffing':
                    location = [999.0, 999.0, 999.0];
                    description = 'Credential Stuffing: Valid credentials from anomalous location';
                    break;
                case 'session_hijack':
                    location = userBaseline.location.map(c => c + Math.random() * 0.5);
                    description = 'Session Hijacking: Suspicious context mismatch detected';
                    break;
            }
            
            const timeFactor = Date.now() / 10000;
            const field = fieldCoordinator.calculateCoordinatedField(...location, timeFactor);
            const authScore = field.coherence * 0.7 + field.stability * 0.3;
            const threat = calculateThreatLevel(field.coherence);
            
            blockedCount++;
            document.getElementById('blockedCount').textContent = blockedCount;
            
            updateDisplay(field.coherence, field.stability, authScore, threat);
            addToChart(field.coherence, field.stability);
            addSecurityEvent(attackType, description, threat, field.coherence);
        }

        function toggleSimulation() {
            isSimulating = !isSimulating;
            const btn = document.getElementById('simulateBtn');
            
            if (isSimulating) {
                btn.textContent = 'Stop Simulation';
                btn.className = 'px-6 py-3 rounded-lg font-semibold transition-all bg-red-500 hover:bg-red-600 text-white';
                
                simulationInterval = setInterval(() => {
                    const rand = Math.random();
                    if (rand < 0.7) {
                        simulateLegitimate();
                    } else if (rand < 0.85) {
                        simulateAttack('brute_force');
                    } else if (rand < 0.95) {
                        simulateAttack('credential_stuffing');
                    } else {
                        simulateAttack('session_hijack');
                    }
                }, 2000);
            } else {
                btn.textContent = 'Start Simulation';
                btn.className = 'px-6 py-3 rounded-lg font-semibold transition-all bg-blue-500 hover:bg-blue-600 text-white';
                clearInterval(simulationInterval);
            }
        }

        // Initialize with baseline data
        simulateLegitimate();
    </script>
</body>
</html>